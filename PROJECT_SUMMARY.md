# è¯ç‰©æé†’ç³»ç»Ÿ - é¡¹ç›®æ”¹é€ æ€»ç»“

## ğŸ“ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å·²æˆåŠŸå°†åŸæœ‰çš„ Manus OAuth è®¤è¯ç³»ç»Ÿæ›¿æ¢ä¸ºæœ¬åœ°ç”¨æˆ·å/å¯†ç ç™»å½•ç³»ç»Ÿï¼Œå¹¶æ·»åŠ äº†å®Œæ•´çš„ Docker å®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒã€‚

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. è®¤è¯ç³»ç»Ÿæ”¹é€ 

#### ç§»é™¤çš„å†…å®¹
- âŒ Manus OAuth è®¤è¯æµç¨‹
- âŒ `server/_core/oauth.ts` - OAuthå›è°ƒå¤„ç†
- âŒ `server/_core/sdk.ts` - Manus SDKé›†æˆ
- âŒ ç¯å¢ƒå˜é‡ï¼š`VITE_APP_ID`, `OAUTH_SERVER_URL`, `OWNER_OPEN_ID`, `VITE_OAUTH_PORTAL_URL`

#### æ–°å¢çš„å†…å®¹
- âœ… æœ¬åœ°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
- âœ… ç”¨æˆ·å/å¯†ç ç™»å½•
- âœ… bcrypt å¯†ç åŠ å¯†
- âœ… JWT Session ç®¡ç†
- âœ… `server/_core/auth.ts` - æ–°çš„è®¤è¯æœåŠ¡
- âœ… `client/src/pages/Login.tsx` - ç™»å½•/æ³¨å†Œé¡µé¢

### 2. æ•°æ®åº“æ”¹é€ 

#### Schema å˜æ›´
```sql
-- ç§»é™¤å­—æ®µ
- openId (varchar)
- loginMethod (varchar)

-- æ–°å¢å­—æ®µ
+ username (varchar, unique, not null)
+ password (varchar, not null)
```

#### æ–°å¢æ•°æ®åº“æ“ä½œ
- `createUser()` - åˆ›å»ºæ–°ç”¨æˆ·ï¼ˆå«å¯†ç åŠ å¯†ï¼‰
- `authenticateUser()` - éªŒè¯ç”¨æˆ·åå’Œå¯†ç 
- `getUserById()` - æ ¹æ®IDè·å–ç”¨æˆ·
- `updateUserLastSignIn()` - æ›´æ–°æœ€åç™»å½•æ—¶é—´

### 3. Docker å®¹å™¨åŒ–

#### æ–°å¢æ–‡ä»¶
- âœ… `Dockerfile` - åº”ç”¨å®¹å™¨é•œåƒé…ç½®
- âœ… `docker-compose.yml` - å¤šå®¹å™¨ç¼–æ’é…ç½®
- âœ… `.dockerignore` - Dockeræ„å»ºå¿½ç•¥æ–‡ä»¶
- âœ… `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹
- âœ… `start.sh` - å¿«é€Ÿå¯åŠ¨è„šæœ¬

#### å®¹å™¨æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  medicine-reminder-app (Node.js)    â”‚
â”‚  - Port: 3000                        â”‚
â”‚  - åº”ç”¨æœåŠ¡å™¨                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  medicine-reminder-db (MySQL 8.0)   â”‚
â”‚  - Port: 3306                        â”‚
â”‚  - æ•°æ®æŒä¹…åŒ–                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. æ–‡æ¡£ç¼–å†™

#### æ–°å¢æ–‡æ¡£
- âœ… `README.md` - é¡¹ç›®ä»‹ç»å’Œå¿«é€Ÿå¼€å§‹
- âœ… `DOCKER_DEPLOYMENT.md` - Dockeréƒ¨ç½²è¯¦ç»†æŒ‡å—
- âœ… `INSTALLATION_GUIDE.md` - å®Œæ•´å®‰è£…é…ç½®æŒ‡å—
- âœ… `PROJECT_SUMMARY.md` - æœ¬æ–‡æ¡£

#### æ–‡æ¡£å†…å®¹
- ç³»ç»Ÿè¦æ±‚å’Œç¯å¢ƒé…ç½®
- è¯¦ç»†çš„å®‰è£…æ­¥éª¤
- Docker å’Œæœ¬åœ°å¼€å‘ä¸¤ç§éƒ¨ç½²æ–¹å¼
- å¸¸ç”¨å‘½ä»¤å’Œæ•…éšœæ’æŸ¥
- å®‰å…¨å»ºè®®å’Œæ€§èƒ½ä¼˜åŒ–
- å¤‡ä»½æ¢å¤æµç¨‹

### 5. ä»£ç è´¨é‡

#### éªŒè¯é€šè¿‡
- âœ… TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
- âœ… é¡¹ç›®æ„å»ºæˆåŠŸ
- âœ… æ‰€æœ‰ä¾èµ–æ­£ç¡®å®‰è£…
- âœ… Git æäº¤å†å²æ¸…æ™°

## ğŸ”§ æŠ€æœ¯æ ˆ

### å‰ç«¯
- React 19
- TypeScript
- TailwindCSS
- Radix UI
- Wouter (è·¯ç”±)
- TanStack Query

### åç«¯
- Node.js 22
- Express
- tRPC
- Drizzle ORM
- bcryptjs (å¯†ç åŠ å¯†)
- jose (JWT)

### æ•°æ®åº“
- MySQL 8.0

### éƒ¨ç½²
- Docker
- Docker Compose

## ğŸ“¦ ç¯å¢ƒå˜é‡é…ç½®

### å¿…éœ€é…ç½®

```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL=mysql://medicine_user:password@db:3306/medicine_reminder

# JWTå¯†é’¥ï¼ˆåŠ¡å¿…ä¿®æ”¹ï¼‰
JWT_SECRET=your-very-long-random-secret-key

# MySQLé…ç½®ï¼ˆDockerï¼‰
MYSQL_ROOT_PASSWORD=rootpassword
MYSQL_DATABASE=medicine_reminder
MYSQL_USER=medicine_user
MYSQL_PASSWORD=medicine_password
```

### å¯é€‰é…ç½®

```env
# æœåŠ¡å™¨ç«¯å£
PORT=3000

# è¿è¡Œç¯å¢ƒ
NODE_ENV=production
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/Kobevictor/medicine-reminder.git
cd medicine-reminder

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œä¿®æ”¹å¯†ç å’ŒJWTå¯†é’¥

# 3. ä¸€é”®å¯åŠ¨
./start.sh

# 4. è®¿é—®åº”ç”¨
# http://localhost:3000
```

### æ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. å¯åŠ¨å®¹å™¨
docker compose up -d

# 2. åˆå§‹åŒ–æ•°æ®åº“
docker compose exec app pnpm run db:push

# 3. æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

## ğŸ“Š é¡¹ç›®ç»“æ„

```
medicine-reminder/
â”œâ”€â”€ client/                    # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â””â”€â”€ Login.tsx     # æ–°å¢ï¼šç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ components/       # UIç»„ä»¶
â”‚   â”‚   â””â”€â”€ hooks/            # React Hooks
â”œâ”€â”€ server/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ _core/
â”‚   â”‚   â”œâ”€â”€ auth.ts           # æ–°å¢ï¼šè®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ context.ts        # ä¿®æ”¹ï¼šä½¿ç”¨æ–°è®¤è¯
â”‚   â”‚   â”œâ”€â”€ env.ts            # ä¿®æ”¹ï¼šç§»é™¤OAuthé…ç½®
â”‚   â”‚   â””â”€â”€ index.ts          # ä¿®æ”¹ï¼šæ³¨å†Œè®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ db.ts                 # ä¿®æ”¹ï¼šæ–°å¢ç”¨æˆ·æ“ä½œ
â”‚   â””â”€â”€ routers.ts            # APIè·¯ç”±
â”œâ”€â”€ drizzle/                   # æ•°æ®åº“
â”‚   â”œâ”€â”€ schema.ts             # ä¿®æ”¹ï¼šæ–°ç”¨æˆ·è¡¨ç»“æ„
â”‚   â””â”€â”€ 0003_local_auth.sql   # æ–°å¢ï¼šè¿ç§»è„šæœ¬
â”œâ”€â”€ Dockerfile                 # æ–°å¢ï¼šDockeré•œåƒ
â”œâ”€â”€ docker-compose.yml         # æ–°å¢ï¼šå®¹å™¨ç¼–æ’
â”œâ”€â”€ .env.example              # æ–°å¢ï¼šç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ start.sh                  # æ–°å¢ï¼šå¯åŠ¨è„šæœ¬
â”œâ”€â”€ README.md                 # æ–°å¢ï¼šé¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ DOCKER_DEPLOYMENT.md      # æ–°å¢ï¼šéƒ¨ç½²æŒ‡å—
â””â”€â”€ INSTALLATION_GUIDE.md     # æ–°å¢ï¼šå®‰è£…æŒ‡å—
```

## ğŸ” å®‰å…¨æ€§æ”¹è¿›

### å¯†ç å®‰å…¨
- âœ… ä½¿ç”¨ bcrypt åŠ å¯†ï¼ˆ10è½®saltï¼‰
- âœ… å¯†ç ä¸ä»¥æ˜æ–‡å­˜å‚¨
- âœ… ç™»å½•å¤±è´¥ä¸æ³„éœ²å…·ä½“ä¿¡æ¯

### Session å®‰å…¨
- âœ… JWT token æœ‰æ•ˆæœŸç®¡ç†
- âœ… HttpOnly Cookie
- âœ… Secure Cookieï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- âœ… SameSite Cookie è®¾ç½®

### æ•°æ®åº“å®‰å…¨
- âœ… å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥
- âœ… ç‹¬ç«‹æ•°æ®åº“ç”¨æˆ·æƒé™
- âœ… å¯†ç å¼ºåº¦è¦æ±‚

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ„å»ºä¼˜åŒ–
- ä½¿ç”¨ Vite è¿›è¡Œå¿«é€Ÿæ„å»º
- ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- é™æ€èµ„æºå‹ç¼©

### æ•°æ®åº“ä¼˜åŒ–
- ç´¢å¼•ä¼˜åŒ–ï¼ˆusername unique indexï¼‰
- è¿æ¥æ± ç®¡ç†
- æŸ¥è¯¢ä¼˜åŒ–

### Docker ä¼˜åŒ–
- å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒä½“ç§¯
- ç”Ÿäº§ä¾èµ–åˆ†ç¦»
- å¥åº·æ£€æŸ¥é…ç½®

## ğŸ› å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

### å½“å‰é™åˆ¶
1. âŒ ä¸æ”¯æŒå¯†ç é‡ç½®åŠŸèƒ½ï¼ˆéœ€è¦ç®¡ç†å‘˜æ‰‹åŠ¨é‡ç½®ï¼‰
2. âŒ ä¸æ”¯æŒé‚®ç®±éªŒè¯
3. âŒ ä¸æ”¯æŒå¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰
4. âŒ ä¸æ”¯æŒç¤¾äº¤ç™»å½•

### æœªæ¥æ”¹è¿›æ–¹å‘
1. æ·»åŠ å¯†ç é‡ç½®åŠŸèƒ½
2. å®ç°é‚®ç®±éªŒè¯
3. æ·»åŠ ç”¨æˆ·ä¸ªäººèµ„æ–™ç®¡ç†
4. å®ç°ç®¡ç†å‘˜åå°
5. æ·»åŠ æ—¥å¿—å®¡è®¡åŠŸèƒ½

## ğŸ“ æ•°æ®åº“è¿ç§»

### ä»æ—§ç‰ˆæœ¬è¿ç§»

å¦‚æœæ‚¨æœ‰ä½¿ç”¨ Manus OAuth çš„æ—§æ•°æ®ï¼Œéœ€è¦æ‰‹åŠ¨è¿ç§»ï¼š

```sql
-- 1. å¤‡ä»½ç°æœ‰æ•°æ®
mysqldump -u root -p medicine_reminder > backup_old.sql

-- 2. åº”ç”¨è¿ç§»è„šæœ¬
mysql -u root -p medicine_reminder < drizzle/0003_local_auth.sql

-- 3. ä¸ºç°æœ‰ç”¨æˆ·åˆ›å»ºç™»å½•å‡­è¯ï¼ˆéœ€è¦æ‰‹åŠ¨å¤„ç†ï¼‰
-- æ³¨æ„ï¼šæ—§ç”¨æˆ·éœ€è¦é‡æ–°æ³¨å†Œ
```

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶

### Git æäº¤ä¿¡æ¯

```
feat: æ›¿æ¢Manus OAuthä¸ºæœ¬åœ°ç™»å½•ç³»ç»Ÿå¹¶æ·»åŠ Dockeréƒ¨ç½²æ”¯æŒ

ä¸»è¦æ›´æ”¹ï¼š
- ç§»é™¤Manus OAuthè®¤è¯ï¼Œå®ç°æœ¬åœ°ç”¨æˆ·å/å¯†ç ç™»å½•
- æ·»åŠ ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
- ä½¿ç”¨bcryptåŠ å¯†å¯†ç å­˜å‚¨
- æ›´æ–°æ•°æ®åº“schemaï¼Œæ·»åŠ usernameå’Œpasswordå­—æ®µ
- åˆ›å»ºç™»å½•é¡µé¢ç»„ä»¶
- æ·»åŠ Dockerå’ŒDocker Composeé…ç½®
- ç¼–å†™å®Œæ•´çš„éƒ¨ç½²å’Œå®‰è£…æ–‡æ¡£
- åˆ›å»ºå¿«é€Ÿå¯åŠ¨è„šæœ¬

æŠ€æœ¯æ ˆï¼š
- è®¤è¯ï¼šJWT + bcrypt
- æ•°æ®åº“ï¼šMySQL 8.0
- éƒ¨ç½²ï¼šDocker + Docker Compose
```

### æ–‡ä»¶å˜æ›´ç»Ÿè®¡

```
22 files changed
1999 insertions(+)
440 deletions(-)
```

## ğŸ¯ æµ‹è¯•æ¸…å•

### åŠŸèƒ½æµ‹è¯•
- âœ… ç”¨æˆ·æ³¨å†Œ
- âœ… ç”¨æˆ·ç™»å½•
- âœ… Session æŒä¹…åŒ–
- âœ… ç™»å‡ºåŠŸèƒ½
- âœ… å—ä¿æŠ¤è·¯ç”±è®¿é—®æ§åˆ¶

### æ„å»ºæµ‹è¯•
- âœ… TypeScript ç¼–è¯‘é€šè¿‡
- âœ… Vite æ„å»ºæˆåŠŸ
- âœ… esbuild æœåŠ¡ç«¯æ„å»ºæˆåŠŸ

### éƒ¨ç½²æµ‹è¯•
- âš ï¸ Docker é•œåƒæ„å»ºï¼ˆæœªåœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼‰
- âš ï¸ Docker Compose å¯åŠ¨ï¼ˆæœªåœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼‰
- âš ï¸ æ•°æ®åº“è¿ç§»ï¼ˆæœªåœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼‰

## ğŸ“ æ”¯æŒä¸è”ç³»

### æ–‡æ¡£èµ„æº
- [README.md](./README.md) - é¡¹ç›®ä»‹ç»
- [DOCKER_DEPLOYMENT.md](./DOCKER_DEPLOYMENT.md) - Dockeréƒ¨ç½²
- [INSTALLATION_GUIDE.md](./INSTALLATION_GUIDE.md) - å®‰è£…æŒ‡å—

### é—®é¢˜åé¦ˆ
- GitHub Issues: https://github.com/Kobevictor/medicine-reminder/issues

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

**æ”¹é€ å®Œæˆæ—¥æœŸ**: 2024-02-12  
**æ”¹é€ è€…**: Manus AI Agent  
**ç‰ˆæœ¬**: v1.0.0
